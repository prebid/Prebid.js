<!--
  Before testing our ad you need to use our geolocaiton widget.
  I've added it to this webpage.
  Click on update your position and type "Ayguesvives" then click on V for this example.
  our widget will set a cookie that geolocation and an ad will be displayed after you'll reload the page.
-->

<html>

<head>
    <script async src="../../build/dev/prebid.js"></script>
    <script async src="https://www.googletagservices.com/tag/js/gpt.js"></script>
    <link rel="stylesheet" href="https://abs.proxistore.com/assets/css/proxistore.min.css">
    <script src="https://abs.proxistore.com/js/proxistore.min.js"></script>
    <script type="text/javascript">

    </script>
    <script>
        var FAILSAFE_TIMEOUT = 3300;
        var PREBID_TIMEOUT = 1000;

        var adUnits = [
            {
                code: 'half-page',
                mediaTypes: {
                    banner: {
                        sizes: [[300, 600]]
                    }
                },
                bids: [
                    {
                        bidder: 'proxistore',
                        params: {
                            website: 'example.com',
                            language: 'fr'
                        }
                    }]
            },
            {
                code: 'rectangle',
                mediaTypes: {
                    banner: {
                        sizes: [[300, 250]]
                    }
                },
                bids: [{
                    bidder: 'proxistore',
                    params: {
                        website: 'example.com',
                        language: 'fr'
                    }
                }]
            },
            {
                code: 'leaderboard',
                mediaTypes: {
                    banner: {
                        sizes: [[970, 250]]
                    }
                },
                bids: [{
                    bidder: 'proxistore',
                    params: {
                        website: 'example.com',
                        language: 'fr'
                    }
                }]
            }
        ];

        var pbjs = pbjs || {};
        pbjs.que = pbjs.que || [];

    </script>

    <script>
        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];
        googletag.cmd.push(function () {
            googletag.pubads().disableInitialLoad();
        });

        pbjs.que.push(function () {
            pbjs.addAdUnits(adUnits);
            pbjs.requestBids({
                bidsBackHandler: sendAdserverRequest,
                timeout: PREBID_TIMEOUT
            });
        });

        function sendAdserverRequest() {
            if (pbjs.adserverRequestSent) return;
            pbjs.adserverRequestSent = true;
            googletag.cmd.push(function () {
                pbjs.que.push(function () {
                    pbjs.setTargetingForGPTAsync();
                    googletag.pubads().refresh();
                });
            });
        }

        setTimeout(function () {
            sendAdserverRequest();
        }, FAILSAFE_TIMEOUT);

    </script>

    <script>
        googletag.cmd.push(function () {
            googletag.defineSlot('/19968336/header-bid-tag-0', [[300, 250], [300, 600]], 'div-gpt-ad-1460505748561-0').addService(googletag.pubads());

            googletag.pubads().enableSingleRequest();
            googletag.enableServices();
        });
    </script>
</head>

<body>
    <h2>Prebid.js Test</h2>
    <div id="widgetId"></div>
    <script>
        Proxistore.config({
            language: "en",
            darkTheme: false,
            widgetIds: ["widgetId"],
        });      
    </script>

    <h5>Div-1</h5>

    <div id='div-gpt-ad-1460505748561-0'>
        <script type='text/javascript'>
            googletag.cmd.push(function () { googletag.display('div-gpt-ad-1460505748561-0'); });
        </script>
    </div>
</body>

</html>