<html>

<head>
    <link rel="icon" type="image/png" href="/favicon.png">
    <script async src="//www.googletagservices.com/tag/js/gpt.js"></script>
    <script async src="prebid.js"></script>

    <script>
        var div_1_sizes = [
            [300, 250],
            [300, 600]
        ];
        var div_2_sizes = [
            [728, 90],
            [970, 250]
        ];
        var PREBID_TIMEOUT = 1000;
        var FAILSAFE_TIMEOUT = 3000;
        var adUnits = [
            {
                code: '/19968336/header-bid-tag-1',
                mediaTypes: {
                    banner: {
                        sizes: div_2_sizes
                    }
                },
                bids: [{
                    bidder: 'appnexus',
                    params: {
                        placementId: 13144370
                    }
                }, {
                    bidder: 'pubmatic',
                    params: {
                        publisherId: '5890',
                        adSlot: '/43743431/DMDemo@728x90:0',
                        pmzoneid: 'zone1',
                        lat: '40.712775',
                        lon: '-74.005973',
                        yob: '1982',
                        kadpageurl: 'www.yahoo.com',
                        gender: 'M',
                        kadfloor: '1.75',
                        bcat: ['IAB1-1', 'IAB1-2']
                    }
                }]
            }
        ];

        // ======== DO NOT EDIT BELOW THIS LINE =========== //
        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];
        googletag.cmd.push(function () {
            googletag.pubads().disableInitialLoad();
        });

        var pbjs = pbjs || {};
        pbjs.que = pbjs.que || [];

        pbjs.que.push(function () {
            pbjs.addAdUnits(adUnits);
            pbjs.setConfig({
                userSync: {
                    filterSettings: { iframe: { bidders: '*', filter: 'include' } },
                    enabledBidders: ['pubmatic'],
                    syncDelay: 3000,
                    userIds: [{
                        name: "sharedId",
                        storage: {
                            type: "cookie",
                            name: `_pubcid`,         // create a cookie with this name
                            expires: 365             // expires in 1 years
                        }
                    }, {
                        name: "criteo",
                    }, {
                        name: "pubCommonId",
                        storage: {
                            type: "cookie",
                            name: "_pubcid",         // create a cookie with this name
                            expires: 365             // expires in 1 years
                        }
                    }, {
                        name: 'hadronId',
                        storage: {
                            name: 'hadronId',
                            type: 'html5'
                        }
                    }],
                    auctionDelay: 0,
                    encryptedSignalSources: {
                        // Eids sources for which signals needs to register. 
                        "sources": [{
                            source: ['sharedid.org', 'criteo.com', 'pubcid.org', 'audigent.com'],
                            encrypt: false
                        }, {
                            source: ['pubmatic.com'],
                            //Custom sources can be identified if customFunc is defined
                            customFunc: () => {
                                return '{"keywords":["tech","auto"]}';
                            },
                            encrypt: true
                        }, {
                            source: ['segment.com'],
                            customFunc: () => {
                                return '[{ "id": "1", "value": "seg1" },{ "id": "2", "value": "seg2" }]';
                            },
                            encrypt: true
                        }],
                        // To delay the Registration of function to create encrypted signals 
                        "registerDelay": 3000
                    }
                }
            });
            pbjs.requestBids({
                bidsBackHandler: initAdserver,
                timeout: PREBID_TIMEOUT
            });
        });




        function initAdserver() {
            if (pbjs.initAdserverSet) return;
            pbjs.initAdserverSet = true;
            googletag.cmd.push(function () {
                pbjs.que.push(function () {
                    pbjs.setTargetingForGPTAsync();
                    pbjs.registerSignalSources();
                    googletag.pubads().refresh();
                });
            });
        }
        // in case PBJS doesn't load
        setTimeout(function () {
            initAdserver();
        }, FAILSAFE_TIMEOUT);

        googletag.cmd.push(function () {
            googletag.defineSlot('/19968336/header-bid-tag-0', div_1_sizes, 'div-1').addService(googletag.pubads());
            googletag.defineSlot('/19968336/header-bid-tag-1', div_2_sizes, 'div-2').addService(googletag.pubads());
            googletag.enableServices();
        });

    </script>

</head>

<body>
    <h2>Basic Prebid.js Example</h2>

    <h5>Div-1</h5>
    <div id='div-1'>
        <script type='text/javascript'>
            googletag.cmd.push(function () {
                googletag.display('div-1');
            });

        </script>
    </div>

    <br>

    <h5>Div-2</h5>
    <div id='div-2'>
        <script type='text/javascript'>
            googletag.cmd.push(function () {
                googletag.display('div-2');
            });

        </script>
    </div>

</body>

</html>